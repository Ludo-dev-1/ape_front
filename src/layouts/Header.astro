---
import { Image } from "astro:assets";
import apeLogo from "../assets/apeLogo.jpg";

const user = {
    role: "",
};
---

<!-- Header -->
<header class="bg-white shadow">
    <div class="container mx-auto px-4 py-4 flex items-center justify-between">
        <a href="/">
            <Image src={apeLogo} alt="Logo Association" class="w-12 h-12" />
        </a>

        <!-- Menu burger -->
        <div class="md:hidden">
            <input type="checkbox" id="menu-toggle" class="peer hidden" />
            <label for="menu-toggle" class="cursor-pointer">
                <svg
                    class="w-6 h-6 text-gray-800"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </label>
        </div>

        <!-- Navigation -->
        <nav id="nav-menu" class="hidden md:block">
  <ul class="flex space-x-6 text-sm font-medium">
    <li><a href="/" class="hover:text-blue-600">Accueil</a></li>
    <li><a href="/news" class="hover:text-blue-600">Actualités</a></li>
    <li><a href="/events" class="hover:text-blue-600">Événements</a></li>
    <li><a href="/contact" class="hover:text-blue-600">Contact</a></li>
  </ul>
</nav>




        <!-- Menu mobile -->
        <div class="peer-checked:block hidden md:hidden px-4 pb-4">
            <ul class="flex flex-col space-y-2 text-sm font-medium">
                <li>
                    <a href="/" class="block hover:text-blue-600">Accueil</a>
                </li>
                <li>
                    <a href="/news" class="block hover:text-blue-600"
                        >Actualités</a
                    >
                </li>
                <li>
                    <a href="/events" class="block hover:text-blue-600"
                        >Événements</a
                    >
                </li>
                <li>
                    <a href="/contact" class="block hover:text-blue-600"
                        >Contact</a
                    >
                </li>
                 {!user.role && (
                <li>
                    <a href="/register" class="hover:text-blue-600"
                        >Inscription</a>
                </li>
                <li>
                    <a href="/login" class="hover:text-blue-600">Connexion</a>
                </li>
                )}
            </ul>
        </div>
    </div>
</header>
<script type="module">
  const token = localStorage.getItem("token");
  const role = localStorage.getItem("role_id"); // Récupère le rôle
  const navMenu = document.getElementById("nav-menu").querySelector("ul");

  if (token) {
    // Utilisateur connecté
    if (role === "1") {
      // Admin
      navMenu.innerHTML += `
        <li><a href="/backoffice" class="hover:text-blue-600">Back-Office</a></li>
        <li><button id="logout-btn" class="hover:text-blue-600 cursor-pointer">Déconnexion</button></li>
      `;
    } else {
      // Utilisateur normal
      navMenu.innerHTML += `
        <li><a href="/profile" class="hover:text-blue-600">Mon Profil</a></li>
        <li><button id="logout-btn" class="hover:text-blue-600 cursor-pointer">Déconnexion</button></li>
      `;
    }

    document.getElementById("logout-btn").addEventListener("click", () => {
      localStorage.clear();
      window.location.href = "/"; // Redirige après déconnexion
    });
  } else {
    // Utilisateur non connecté
    navMenu.innerHTML += `
      <li><a href="/register" class="hover:text-blue-600">Inscription</a></li>
      <li><a href="/login" class="hover:text-blue-600">Connexion</a></li>
    `;
  }
</script>
